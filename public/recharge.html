<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>充值 - 作业批改系统</title>
    <link rel="icon" type="image/svg+xml" href="favicon.svg">
    <link rel="stylesheet" href="styles.css">
</head>
<body>
    <!-- 毛玻璃页头 -->
    <header class="glass-header">
        <div class="header-content">
            <a href="submit.html" class="back-btn">
                <span>← 返回</span>
            </a>
            <div class="header-title">
                <h1>💳 账户充值</h1>
            </div>
            <div class="user-info" id="userInfo" style="display: none;">
                <span id="usernameDisplay"></span>
            </div>
        </div>
    </header>

    <div class="container">
        <!-- 当前余额 -->
        <div class="balance-card">
            <div class="balance-info">
                <span class="balance-label">当前余额</span>
                <span class="balance-amount" id="currentBalance">¥0.00</span>
            </div>
            <div class="quota-summary">
                <p>💡 每次批改费用：<strong>¥0.01</strong></p>
                <p>🎁 每日免费额度：<strong id="dailyQuotaInfo">50 次</strong></p>
                <p>✅ 今日剩余额度：<strong id="remainingQuotaInfo" style="color: #ffffff; text-shadow: 0 1px 2px rgba(0,0,0,0.2);">- 次</strong></p>
            </div>
        </div>

        <!-- 充值金额选择 -->
        <section class="card">
            <h2>选择充值金额</h2>
            <div class="recharge-options">
                <button class="recharge-btn" data-amount="1">
                    <span class="amount">¥1</span>
                    <span class="desc">约 100 次</span>
                </button>
                <button class="recharge-btn" data-amount="5">
                    <span class="amount">¥5</span>
                    <span class="desc">约 500 次</span>
                </button>
                <button class="recharge-btn" data-amount="10">
                    <span class="amount">¥10</span>
                    <span class="desc">约 1000 次</span>
                </button>
                <button class="recharge-btn" data-amount="20">
                    <span class="amount">¥20</span>
                    <span class="desc">约 2000 次</span>
                </button>
                <button class="recharge-btn" data-amount="50">
                    <span class="amount">¥50</span>
                    <span class="desc">约 5000 次</span>
                </button>
                <button class="recharge-btn custom-amount">
                    <span class="amount">自定义</span>
                    <input type="number" id="customAmount" placeholder="输入金额" min="0.01" step="0.01" style="display: none;">
                </button>
            </div>
        </section>

        <!-- 支付方式 -->
        <section class="card">
            <h2>选择支付方式</h2>
            <div class="payment-methods" style="grid-template-columns: repeat(2, 1fr);">
                <label class="payment-option">
                    <input type="radio" name="paymentMethod" value="alipay" checked>
                    <div class="payment-card">
                        <span class="payment-icon">💙</span>
                        <span class="payment-name">支付宝</span>
                    </div>
                </label>
                <label class="payment-option">
                    <input type="radio" name="paymentMethod" value="wechat">
                    <div class="payment-card">
                        <span class="payment-icon">💚</span>
                        <span class="payment-name">微信支付</span>
                    </div>
                </label>
            </div>
        </section>

        <!-- 确认充值按钮 -->
        <button class="btn btn-primary" id="confirmRecharge" style="width: 100%; margin-top: 1rem; padding: 0.875rem 1.5rem;">
            <span>💰 生成收款码</span>
        </button>

        <!-- 收款码显示模态框 -->
        <div class="modal" id="qrcodeModal" style="display: none;">
            <div class="modal-content" style="max-width: 500px;">
                <div class="modal-header">
                    <h3>扫码支付</h3>
                    <button class="modal-close" onclick="closeQrcodeModal()">×</button>
                </div>
                <div class="modal-body" style="text-align: center; padding: 2rem;">
                    <div id="qrcodeContainer" style="margin-bottom: 1.5rem;">
                        <!-- 收款码将显示在这里 -->
                    </div>
                    <div style="background: #f0f9ff; padding: 1rem; border-radius: 8px; margin-bottom: 1rem;">
                        <p style="margin: 0 0 0.5rem 0; font-weight: 600; color: #1e40af;">充值金额：<span id="displayAmount" style="font-size: 1.5rem;">¥0.00</span></p>
                        <p style="margin: 0; font-size: 0.875rem; color: #64748b;">请使用 <span id="displayMethod">支付宝</span> 扫码支付</p>
                    </div>
                    <div style="background: #fef3c7; padding: 1rem; border-radius: 8px; font-size: 0.875rem; color: #92400e; text-align: left;">
                        <p style="margin: 0 0 0.5rem 0; font-weight: 600;">⚠️ 重要提示：</p>
                        <p style="margin: 0 0 0.25rem 0;">1. 请务必转账<strong>准确金额</strong></p>
                        <p style="margin: 0 0 0.25rem 0;">2. 支付完成后点击下方"确认到账"</p>
                        <p style="margin: 0;">3. 到账后余额将自动更新</p>
                    </div>
                </div>
                <div class="modal-footer">
                    <button class="btn btn-secondary" onclick="closeQrcodeModal()">取消支付</button>
                    <button class="btn btn-primary" onclick="confirmPayment()">✅ 已完成支付</button>
                </div>
            </div>
        </div>

        <!-- 交易记录 -->
        <section class="card" style="margin-top: 2rem;">
            <h2>交易记录</h2>
            <div id="transactionsList">
                <p style="text-align: center; color: #666;">加载中...</p>
            </div>
        </section>

        <div id="errorMessage" class="error-message" style="display: none;"></div>

        <footer class="footer">
            <p>© 2026 智能作业批改系统 | Powered by DB科技</p>
        </footer>
    </div>

    <!-- 移动端底部导航栏 -->
    <nav class="mobile-nav" id="mobileNav">
        <a href="index.html" class="nav-item">
            <span class="nav-icon">🏠</span>
            <span class="nav-label">首页</span>
        </a>
        <a href="submit.html" class="nav-item">
            <span class="nav-icon">📝</span>
            <span class="nav-label">提交</span>
        </a>
        <a href="add-question.html" class="nav-item teacher-only" style="display: none;">
            <span class="nav-icon">➕</span>
            <span class="nav-label">添加</span>
        </a>
        <a href="manage-questions.html" class="nav-item teacher-only" style="display: none;">
            <span class="nav-icon">📋</span>
            <span class="nav-label">管理</span>
        </a>
        <a href="recharge.html" class="nav-item active">
            <span class="nav-icon">💰</span>
            <span class="nav-label">充值</span>
        </a>
    </nav>

    <script src="header-utils.js"></script>
    <script src="recharge.js"></script>
</body>
</html>
